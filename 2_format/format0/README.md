
# Analysis

* We are given with the below source code:

    ![image.png](./image.png)

* Try some random inputs:

    ![image-1.png](./image-1.png)

* We can obviously do this with a standard buffer overflow, but is says it can be done with less than 10 bytes of input. So we'll want to do this by exploiting format strings.

# Exploit

* Lets open this in GDB:

    ![image-2.png](./image-2.png)

* In <span style="color:red">*<vuln+6>*</span>, it <span style="color:red">*mov DWORD PTR [ebp-0xc],0x0*</span>. So this is our <span style="color:red">*target*</span> variable. It starts at [ebp-0xc]. Similarly, <span style="color:red">*buffer*</span> starts at [ebp-0x4c].

* The distance between <span style="color:red">*target*</span> and <span style="color:red">*buffer*</span> is 0x4c-0xc=0x40=64 bytes. So we need to write pass <span style="color:red">*buffer*</span> into <span style="color:red">*target*</span> with 64 bytes + 4 bytes we want <span style="color:red">*target*</span> to be (in this case: 0xdeadbeef).

* One method of exploiting format strings is pretty similar to buffer overflows. You can write a large string into a buffer with a relatively short format string. For example, a format string %32d results in a 32 byte string.

* Without further ado, lets write the exploit code:

    ![image-3.png](./image-3.png)

# The bugs:

* The vulnerability is at the <span style="color:red">*sprintf*</span> function:

    ![image-4.png](./image-4.png)
