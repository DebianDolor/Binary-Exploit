

# Analysis

* We are given with the below source code:

    ![image.png](./image.png)

* Try some random inputs:

    ![image-1.png](./image-1.png)

* It doesn't show anything! 

* Our goal here is to try to make it call the <span style="color:red">*win()*</span> function.

# Exploit

* Lets load this in GDB:

    ![image-2.png](./image-2.png)

* So in here, as in <span style="color:red">*stack0*</span>, the <span style="color:red">*fp*</span> variable is located at memory address <span style="color:red">*esp+0x5c*</span> and <span style="color:red">*buffer*</span> starts at <span style="color:red">*esp+0x1c*</span>.

* The key point of the program is in the following lines:

    ![image-3.png](./image-3.png)

* We move <span style="color:red">*fp*</span> to <span style="color:red">*eax*</span> and then it is called. If we can change <span style="color:red">*fp*</span> so that it points to the memory location of <span style="color:red">*win()*</span>, we have our wishes.

* In order to do that, we must first find the address of <span style="color:red">*win()*</span>, then append it to the exploit code we've written earlier.

* With <span style="color:red">*info functions*</span> and <span style="color:red">*disas win*</span>, we see that the function starts at <span style="color:red">*0x08048424*</span>:

    ![image-4.png](./image-4.png)

* So now just do the thing we've done in the previous levels:

    ![image-5.png](./image-5.png)

# Bugs

* Same as previous level, the bug is at the <span style="color:red">*gets*</span> function.


    




