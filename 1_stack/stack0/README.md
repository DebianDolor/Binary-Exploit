# Analysis

* We are given with the below source code:

    ![image.png](./image.png)

* Try some random inputs:

    ![image-1.png](./image-1.png)

# Exploit

* We open the <span style="color:red">*stack0*</span> in GDB and disassemble the main function:

    ![image-2.png](./image-2.png)

* In the <span style="color:red">*<main+9>*</span> line, 0x0 is moved to address <span style="color:red">*esp+0x5c*</span>, then it's moved to EAX and call <span style="color:red">*test eax, eax*</span> to check if this varable is 0 or not. So this is our <span style="color:red">*modified*</span> variable.

* The <span style="color:red">*<main+17>*</span> tells us that the <span style="color:red">*buffer*</span> array starts at address <span style="color:red">*esp+0x1c*</span>.

    ![image-3.png](./image-3.png)

* Here it calls <span style="color:red">*gets*</span> to retrive the user's input.

* Notice that <span style="color:red">*0x5c - 0x1c*</span> is 64 bytes. So <span style="color:red">*buffer*</span> and <span style="color:red">*modified*</span> are allocated right next to each other on the stack. 

* So we can modify the <span style="color:red">*modified*</span> variable by writing past the space allocated space for <span style="color:red">*buffer*</span>:

![image-4.png](./image-4.png)

# The bugs:

* If you take a look at the <span style="color:red">*man*</span> page for <span style="color:red">*gets*</span>, you'll know why we can exploit it:

    ![image-6.png](./image-6.png)




