
# Analysis

* We are given with the below source code:

    ![image.png](./image.png)

* Try some random inputs:

    ![image-1.png](./image-1.png)

* It says: <span style="color:red">*please set the GREENIE environment variable*</span>. Look like we have something to do with environment variables here.

# Exploit

* Again, this is pretty similar to the previous level except that the data is passed in via the enviromental variable <span style="color:red">*GREENIE*</span> and we need to write <span style="color:red">*0x0d0a0d0a*</span> to <span style="color:red">*modified*</span>.

* Lets try the exploit from <span style="color:red">*stack0*</span> here. But instead of passing it to the program, we want to pass this value to a environment variable <span style="color:red">*GREENIE*</span>:

    ![image-2.png](./image-2.png)

* Now run the program:

    ![image-3.png](./image-3.png)

* As you can see, we have written the hex value of "a" (61) to the memory allocated for <span style="color:red">*modified*</span>. Do the samething we did in the previous level:

    ![image-4.png](./image-4.png)

* Result:

    ![image-5.png](./image-5.png)

# Bugs

* The bug appeared in this program is that <span style="color:red">*getenv*</span> is not bounding the buffer length. This is where security bugs like buffer overrun often originate from.

    ![image-6.png](./image-6.png)

    




